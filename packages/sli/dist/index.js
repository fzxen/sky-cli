"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var n,t=require("commander"),i=e(require("log-symbols")),r=e(require("chalk")),o=e(require("ora")),s=e(require("inquirer")),c=e(require("download-git-repo")),a=require("fs"),l=require("path"),u=require("child_process"),p=function(e){return null==e},d={vue:{url:"direct:https://gitee.com/zxffan/templates.git#vue-spa"},react:{url:""},electron:{url:""}};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function f(e,n,t,i){return new(t||(t=Promise))((function(r,o){function s(e){try{a(i.next(e))}catch(e){o(e)}}function c(e){try{a(i.throw(e))}catch(e){o(e)}}function a(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,c)}a((i=i.apply(e,n||[])).next())}))}function m(e,n){var t,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=n.call(e,s)}catch(e){o=[6,e],i=0}finally{t=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}}!function(e){e["babel-eslint"]="^10.1.0",e.eslint="^6.8.0",e["eslint-config-prettier"]="^6.11.0",e["eslint-plugin-prettier"]="^3.1.3",e["eslint-plugin-vue"]="^6.2.2",e.husky="^4.2.5",e["lint-staged"]="^9.5.0",e["postcss-import"]="^12.0.1",e["postcss-loader"]="^3.0.0",e["postcss-preset-env"]="^6.7.0",e.prettier="^1.19.1",e["raw-loader"]="^4.0.1",e.standard="^14.3.3",e["@commitlint/cli"]="^8.3.5",e["@commitlint/config-conventional"]="^8.3.4",e["@poloris/sli-vue"]="0.2.0"}(n||(n={}));var g=n,v=function(e,n){var t=e.name;return e.eslint&&(n.scripts.lint="eslint --ext .js,.vue src",n.scripts.fix="eslint --fix --ext .js,.vue src",n.devDependencies.eslint=g.eslint,n.devDependencies["eslint-config-prettier"]=g["eslint-config-prettier"],n.devDependencies["eslint-plugin-prettier"]=g["eslint-plugin-prettier"],n.devDependencies["eslint-plugin-vue"]=g["eslint-plugin-vue"],n.devDependencies.prettier=g.prettier,n.devDependencies.standard=g.standard,n.devDependencies["babel-eslint"]=g["babel-eslint"],a.copyFile(l.resolve(__dirname,"../sources/vue/.eslintrc.js"),t+"/.eslintrc.js",(function(){})),a.copyFile(l.resolve(__dirname,"../sources/vue/.eslintignore"),t+"/.eslintignore",(function(){}))),n.devDependencies["@poloris/sli-vue"]=g["@poloris/sli-vue"],n},h=function(e,n){return new Promise((function(t){if(a.existsSync(e)){var i=a.readFileSync(e).toString(),r=JSON.parse(i),o=n.name,s=n.description,c=n.author,l=n.frame;Object.assign(r,{name:o,description:s,author:c}),r=function(e,n){var t,i=e.name,r=e.codeLint,o=e.commitLint,s=e.eslint;return(o||s&&r)&&(n.devDependencies.husky=g.husky),o&&(n.husky={hooks:{"commit-msg":"echo 'commit checking.... && commitlint -E HUSKY_GIT_PARAMS"}},n.devDependencies["@commitlint/cli"]=g["@commitlint/cli"],n.devDependencies["@commitlint/config-conventional"]=g["@commitlint/config-conventional"],y(i+"/.commitlintrc.js")),s&&r&&((null===(t=null==n?void 0:n.husky)||void 0===t?void 0:t.hooks)?n.husky.hooks["pre-commit"]="echo 'code checking....' && lint-staged":n.husky={hooks:{"pre-commit":"echo 'code checking....' && lint-staged"}},n["lint-staged"]={"*.{js,vue}":["eslint --fix","git add"]},n.devDependencies["lint-staged"]=g["lint-staged"]),n}(n,r),"vue"===l&&(r=v(n,r)),a.writeFileSync(e,JSON.stringify(r,null,"\t")),t()}}))},y=function(e){return a.copyFile(l.resolve(__dirname,"../sources/.commitlintrc.js"),e,(function(){}))},b=function(e){return h(e.name+"/package.json",e).then((function(){return n=e.name+"/sli.config.js",f(void 0,void 0,void 0,(function(){return m(this,(function(e){return[2,a.copyFileSync(l.resolve(__dirname,"../sources/sli.config.js"),n)]}))}));var n})).then((function(){console.log(i.success,r.green("project has been updated"))}))},k=function(e){(function(e){return new Promise((function(n,t){p(e)&&t(new Error("name must be provided")),a.existsSync(e)?t(new Error(e+" has existed")):n()}))})(e).then((function(){return s.prompt(function(e){return[{type:"list",name:"frame",message:"please choose this project template",choices:["vue","react","electron"]},{type:"input",name:"name",message:"Please enter the project name: ",default:e,validate:function(e){return!!e||"you must provide the name"}},{type:"input",name:"description",message:"Please enter the project description: ",validate:function(e){return!!e||"you must provide the description"}},{type:"input",name:"author",message:"Please enter the author name: ",default:"fanzhongxu",validate:function(e){return!!e||"you must provide the author"}},{type:"confirm",message:"Do you need eslint(standard&prettier)",name:"eslint",default:!0},{type:"confirm",message:"Do you need git hook to lint your commit message",name:"commitLint",default:!0},{type:"confirm",message:"Do you need git hook to lint your code(eslint muse be checked)",name:"codeLint",default:!0}]}(e))})).then((function(e){return n=e,new Promise((function(e,t){var i=n.name,r=n.frame,s=o();s.start("downloading...");var a=d[r];a.url||(s.fail(r+" is not provided for now"),t(new Error)),c(a.url,i,{clone:!0},(function(i){i?(s.fail("download failed, please check your network"),t(i)):(s.succeed("download successfully"),e(n))}))}));var n})).then((function(e){return b(e)})).then((function(){console.log(i.success,function(e){return[r.green("app has been created successfully\n"),"\t cd "+e,"\t npm install or yarn","\t npm start"].join("\n")}(e))})).catch((function(e){e.message&&console.log(i.error,r.red(e.message))}))};var w=function(){s.prompt([{type:"confirm",message:"Do you need initialize a git repository",name:"git",default:!1}]).then((function(e){var n;e instanceof Object&&"git"in e&&(e.git&&((n=o()).start("git repository initializing..."),u.exec("git init",(function(e){p(e)?n.succeed("git repository initialize successfully"):n.fail("git repository initialization failed")}))),function(){var e=o();e.start("npm installing..."),u.exec("npm install",(function(n,t,o){console.log(i.success,r.green(t)),console.log(i.error,r.red(o)),p(n)?e.succeed("npm install successfully"):e.fail("npm install failed")}))}())}))},j=new t.Command;j.command("create <name>").description("create a new project").alias("c").action((function(e){k(e)})),j.command("init").description("initialize project").alias("i").action((function(){w()})),j.version(require("../package.json").version,"-v --version").parse(process.argv),process.argv.slice(2).length||j.outputHelp();
